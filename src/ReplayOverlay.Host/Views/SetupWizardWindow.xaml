<Window x:Class="ReplayOverlay.Host.Views.SetupWizardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Replay Overlay Setup"
        Width="500" Height="420"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="#1a1a2e">

    <Window.Resources>
        <Style x:Key="PageTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#4ecca3"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        <Style x:Key="PageText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#eaeaea"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#eaeaea"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#16213e"/>
            <Setter Property="Foreground" Value="#eaeaea"/>
            <Setter Property="BorderBrush" Value="#2c3e50"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4,3"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#eaeaea"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Background" Value="#2c3e50"/>
            <Setter Property="Foreground" Value="#eaeaea"/>
            <Setter Property="BorderBrush" Value="#2c3e50"/>
            <Setter Property="Padding" Value="20,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="4,0"/>
        </Style>
        <Style x:Key="AccentButton" TargetType="Button">
            <Setter Property="Background" Value="#4ecca3"/>
            <Setter Property="Foreground" Value="#1a1a2e"/>
            <Setter Property="BorderBrush" Value="#4ecca3"/>
            <Setter Property="Padding" Value="20,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="4,0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Page content area -->
        <TabControl x:Name="WizardPages" Grid.Row="0" Margin="24,16,24,0"
                    Background="Transparent" BorderThickness="0">
            <!-- Hide tab headers -->
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </Style>
            </TabControl.ItemContainerStyle>

            <!-- Page 0: Welcome -->
            <TabItem>
                <StackPanel>
                    <TextBlock Style="{StaticResource PageTitle}" Text="Welcome to Replay Overlay"/>
                    <TextBlock Style="{StaticResource PageText}"
                               Text="This wizard will help you set up Replay Overlay for the first time."/>
                    <TextBlock Style="{StaticResource PageText}" Margin="0,12,0,0"
                               Text="Features:"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,4,0,0"
                               Text="- Quick access to scenes, sources, and audio mixer"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- Save replay buffer with a hotkey"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- Automatic organization by game"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- On-screen REC indicator"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="0,16,0,0"
                               Text="Click Next to begin setup."/>
                </StackPanel>
            </TabItem>

            <!-- Page 1: Connection -->
            <TabItem>
                <StackPanel>
                    <TextBlock Style="{StaticResource PageTitle}" Text="Connection"/>
                    <Border Background="#16213e" BorderBrush="#2c3e50" BorderThickness="1"
                            CornerRadius="4" Padding="10" Margin="0,0,0,12">
                        <TextBlock Style="{StaticResource PageText}" TextWrapping="Wrap"
                                   Text="Enable the WebSocket server in your streaming software under Tools > WebSocket Server Settings. Note the port and password."/>
                    </Border>

                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Style="{StaticResource FieldLabel}" Text="WebSocket Port"/>
                        <TextBox Grid.Column="1" x:Name="WizPortBox" Text="4455"/>
                    </Grid>

                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Style="{StaticResource FieldLabel}" Text="Password"/>
                        <TextBox Grid.Column="1" x:Name="WizPasswordBox"/>
                    </Grid>

                    <CheckBox x:Name="WizAutoLaunchCb" Content="Auto-launch streaming software when overlay starts"/>
                    <CheckBox x:Name="WizAutoBufferCb" Content="Auto-start replay buffer on connect"/>
                </StackPanel>
            </TabItem>

            <!-- Page 2: Hotkeys -->
            <TabItem>
                <StackPanel>
                    <TextBlock Style="{StaticResource PageTitle}" Text="Hotkeys"/>

                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Style="{StaticResource FieldLabel}" Text="Toggle Overlay"/>
                        <TextBox Grid.Column="1" x:Name="WizToggleBox" Text="F10"/>
                    </Grid>

                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Style="{StaticResource FieldLabel}" Text="Save Replay"/>
                        <TextBox Grid.Column="1" x:Name="WizSaveBox" Text="F9"/>
                        <Button Grid.Column="2" Style="{StaticResource NavButton}"
                                Content="Sync" FontSize="10" Padding="8,3"
                                Margin="8,0,0,0" Click="WizSyncObs_Click"/>
                    </Grid>

                    <TextBlock Style="{StaticResource PageText}" Foreground="#7f8c8d" Margin="0,8,0,0"
                               Text="Tip: Match the Save Replay hotkey to the Save Replay Buffer hotkey in your streaming software for consistency."/>
                </StackPanel>
            </TabItem>

            <!-- Page 3: Recording Folder -->
            <TabItem>
                <StackPanel>
                    <TextBlock Style="{StaticResource PageTitle}" Text="Recording Folder"/>

                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Grid.Column="0" x:Name="WizFolderBox"/>
                        <Button Grid.Column="1" Style="{StaticResource NavButton}"
                                Content="Detect" FontSize="10" Padding="8,3"
                                Margin="8,0,0,0" Click="WizDetectFolder_Click"/>
                        <Button Grid.Column="2" Content="Browse..." Margin="4,0,0,0"
                                Background="#2c3e50" Foreground="#eaeaea" BorderBrush="#2c3e50"
                                Padding="8,3" Click="WizBrowseFolder_Click"/>
                    </Grid>

                    <CheckBox x:Name="WizOrganizeCb" Content="Organize replays by game (creates subfolders)" IsChecked="True"/>
                    <CheckBox x:Name="WizSyncFolderCb" Content="Sync recording folder automatically" IsChecked="True"/>
                </StackPanel>
            </TabItem>

            <!-- Page 4: Finish -->
            <TabItem>
                <StackPanel>
                    <TextBlock Style="{StaticResource PageTitle}" Text="Setup Complete"/>
                    <TextBlock Style="{StaticResource PageText}"
                               Text="You're all set! Here are some tips:"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,8,0,0"
                               Text="- Press F10 (or your chosen key) to toggle the overlay"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- Press F9 (or your chosen key) to save a replay"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- Right-click the tray icon for quick actions"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="12,0,0,0"
                               Text="- Settings are accessible from the tray or overlay"/>
                    <TextBlock Style="{StaticResource PageText}" Margin="0,16,0,0" Foreground="#7f8c8d"
                               Text="You can change startup and other options in Settings later."/>
                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- Navigation buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal"
                    HorizontalAlignment="Right" Margin="24,12,24,16">
            <Button x:Name="BackButton" Style="{StaticResource NavButton}"
                    Content="Back" Click="Back_Click"/>
            <Button x:Name="NextButton" Style="{StaticResource AccentButton}"
                    Content="Next" Click="Next_Click"/>
            <Button x:Name="FinishButton" Style="{StaticResource AccentButton}"
                    Content="Finish" Visibility="Collapsed" Click="Finish_Click"/>
        </StackPanel>
    </Grid>
</Window>
